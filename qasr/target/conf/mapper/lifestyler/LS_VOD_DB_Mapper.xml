<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="v1.0/LS_VOD_DB">
	<select id="VOD_META_SELECT" resultType="hashmap">
 	<![CDATA[
 		select   pgm_epi_no "frequency" ,title "title" , pgm_epi_no_ottl_nm "subtitle" , brod_sched_ymd "broaddt" 
 		from cms_b_cc_pgm_epi_no   a , vod_master b  where  a.cms_id=b.cms_id and a.cms_sub_id=b.cms_sub_id and  b.cms_id=#{CMSID}  and b.cms_sub_id=#{CMS_SUB_ID} and b.vod_id=#{VOD_ID}
	]]>
	</select>
	
	<select id="VOD_MASTER_SELECT" resultType="hashmap">
	<![CDATA[
		select a.title,  a.cms_id,a.cms_sub_id,a.vod_id,a.vod_code,a.contents,vod_thumnail ,a.create_date from vod_master a, vod_slave b 
		where a.cms_id=#{CMSID}  and a.cms_id = b.cms_id and a.cms_sub_id = b.cms_sub_id and a.vod_id = b.vod_id and b.screen_code='SCC001'
	]]>
	</select>
	
	<select id="VOD_MASTER_INFO_SELECT" resultType="hashmap">
	<![CDATA[
		select a.title "title",  a.cms_id "cmsid",a.cms_sub_id "cmssubid",a.vod_id "vodid",a.contents "contents" ,vod_thumnail "thumbnail" ,a.create_date "createDate" from vod_master a, vod_slave b 
		where a.vod_id=#{VODID}  and a.cms_id = b.cms_id and a.cms_sub_id = b.cms_sub_id and a.vod_id = b.vod_id and b.screen_code='SCC001'
	]]>
	</select>
	
	<select id="EPISODE_OR_CLIP_BY_PROGRAMID_SELECT" resultType="hashmap">
	<![CDATA[
	select * from (
		select  title,  cms_id  ,cms_sub_id, vod_id, vod_code, contents,vod_thumnail , create_date ,rownum rnum from(
		  	select a.title,  a.cms_id,a.cms_sub_id,a.vod_id,a.vod_code,a.contents,vod_thumnail ,a.create_date  from vod_master a, vod_slave b 
			where a.cms_id=#{CMSID} and a.is_use='Y'  and a.cms_id = b.cms_id and a.cms_sub_id = b.cms_sub_id and a.vod_id = b.vod_id and b.screen_code='SCC001' and vod_code=#{VODCODE} 
			order by ${ORDERBY} desc 
	  	) z
    )x where rownum <= ${LIMIT} and rnum  >= ${OFFSET}
	]]>
	</select>
	
	<select id="EPISODE_OR_CLIP_BY_PROGRAMID_COUNT_SELECT" resultType="hashmap">
	<![CDATA[
		  	select count(*)  from vod_master  
			where cms_id=#{CMSID} and vod_code=#{VODCODE} 
	]]>
	</select>
	
	<select id="VOD_TOP30_SELECT" resultType="hashmap">
	<![CDATA[
	select * from (
		select  title,  cms_id  ,cms_sub_id, vod_id, vod_code, contents,vod_thumnail , create_date ,rownum rnum,running_time ,  channelName from(
		  	select a.title,  a.cms_id,a.cms_sub_id,a.vod_id,a.vod_code,a.contents,vod_thumnail ,a.create_date ,a.running_time , d.chnl_nm channelName 
		  	from vod_master a, vod_slave b ,  CMS_B_CC_PGM   c , CMS_B_CM_CHNL d
			where  a.cms_id = b.cms_id and a.cms_sub_id = b.cms_sub_id and a.vod_id = b.vod_id and b.screen_code='SCC001' and vod_code='VOD001' and c.main_chnl_cd =  d.chnl_cd and a.cms_id=c.cms_id
			order by a.create_date desc 
	  	) z
    )x where  rownum < ${LIMIT} and rnum  > ${OFFSET}
    
	]]>
	</select>
	<select id="PROGRAM_PERSON_SELECT" resultType="hashmap">
	<![CDATA[
		select c.PRSN_NM  from CMS_B_CC_PGM   a, CMS_B_CC_PGM_PRSN  b   , CMS_B_CM_PRSN c  where  a.pgm_id=b.pgm_id   and a.cms_id=#{CMSID} and b.prsn_no=c.prsn_no and b.prsn_fg_cd='02' and b.prsn_typ_cd='08'
	]]>
	</select>
	
	<select id="CHANNEL_NAME_BY_CODE_SELECT" resultType="hashmap">
	<![CDATA[
		select chnl_nm
		from CMS_B_CM_CHNL   
		where chnl_cd = #{CHNL_CD} 
	]]>
	</select>
	
</mapper>