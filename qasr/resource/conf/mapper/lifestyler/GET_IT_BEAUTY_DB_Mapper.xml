<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="v1.0/GET_IT_BEAUTY_DB">
	<select id="BEAUTY_TOP30_PRODUCT_META_SELECT" resultType="hashmap">
 	<![CDATA[
 		select top 30 productseq id,productname title, a.imagepath photo ,b.brandKorName  from Product a with(NOLOCK) , brand b with(NOLOCK) where a.contentsYN='Y' and a.brandSeq = b.brandSeq  order by productSeq desc  
    ]]>
	</select>
	<select id="BEAUTY_PRODUCT_META_SELECT" resultType="hashmap">
 	<![CDATA[
 		select productseq "id",productname "title", a.imagepath "photo" ,b.brandKorName "brandtitle"  
 		from Product a with(NOLOCK) , brand b with(NOLOCK)  where a.productseq=#{PRODUCTSEQ} and a.contentsYN='Y' and a.brandSeq = b.brandSeq  order by productSeq desc  
    ]]>
    </select>
	<select id="BEAUTY_CATEGORY_SELECT" resultType="hashmap">
 	<![CDATA[
 		select categoryCode , CategoryName ,depth1 depth from category with(NOLOCK)  where  depth2=0 and depth3=0 and viewYn='Y' and depth1 < 8
    ]]>
	</select>
	<select id="CATEGORY_SELECT" resultType="hashmap">
 	<![CDATA[
 		select categoryCode , CategoryName from category with(NOLOCK)  where  viewYn='Y'
    ]]>
	</select>
	
	<select id="BEAUTY_CATEGORY_SUB_SELECT" resultType="hashmap">
 	<![CDATA[
 		select row_number() over (order by a.categoryCode asc) as rownum,  a.categoryCode ,a.categoryName ,max(b.imagepath) from category  a with(nolock) , (
        select   categoryCode,imagePath   from product with(nolock)   where  viewType='Y' and contentsYn='Y'  and categoryCode like '${CATE}%'
      ) b where b.categoryCode =a.categoryCode  group by a.categoryCode , a.categoryName     
    ]]>
	</select>
	<select id="BEAUTY_CATEGORY_ARTIST_SELECT" resultType="hashmap">
 	<![CDATA[
 		select TOP ${TOP} categoryCode , CategoryName from (
 			select ROW_NUMBER() OVER(ORDER BY Code asc) as rownum ,  Code categoryCode , Name CategoryName from codedefinition with(NOLOCK)   where referenceCode='BAS000'
 		) a  where rownum > #{OFFSET}
 		
    ]]>
	</select>

	<select id="BEAUTY_PRODUCT_BY_CATEGORY_SELECT">
	<![CDATA[
		select TOP ${TOP} productSeq seq ,imagepath thumbnail,title from (
			select ROW_NUMBER() OVER(ORDER BY productSeq desc) as rownum , productSeq,imagepath ,productName  title  from product with(nolock)   where categoryCode=#{CATE} and viewType='Y' and contentsYn='Y'
		) a where rownum > #{OFFSET}
	]]>
	</select>

	<select id="THEME_ARTIST_SELECT" resultType="hashmap">
 	<![CDATA[
 	select TOP ${TOP} commonCode,title from (
		select ROW_NUMBER() OVER(ORDER BY commonCode asc) as rownum , commonCode,title from commonCategory with(nolock) where viewType='Y'
	) a  where rownum > #{OFFSET}
	]]>
	</select>
	
	<select id="THEME_ARTIST_INFO_SELECT" resultType="hashmap">
 	<![CDATA[
		select title,summary, thumbnail from commonCategory with(nolock) where viewType='Y' and commonCode=#{CODE}
	]]>
	</select>

	<select id="BEAUTY_CATEGORY_ARTIST_CONTENT_SELECT" resultType="hashmap">
 	<![CDATA[
 		select TOP ${TOP} * from (
 			select ROW_NUMBER() OVER(ORDER BY TipSeq desc) as rownum ,  * from beautyTip with(NOLOCK)   where artistCode=#{ARTISTID}
 		) a  where rownum > #{OFFSET}
 		
    ]]>
	</select>
	
	
	
	<select id="BEAUTY_BRAND_SELECT" resultType="hashmap">
 	<![CDATA[
 		select TOP ${TOP} BrandSeq brandId,BrandKorName brandKORName,BrandEngName brandENGName, ImagePath photo from  (
 			select ROW_NUMBER() OVER(ORDER BY BrandKorName asc) as rownum , BrandSeq , BrandKorName , BrandEngName, ImagePath from brand with(NOLOCK)  where viewType='Y'  and ContentsYN='Y' 
 		) a  where rownum > #{OFFSET}
    ]]>
	</select>


	<!--  뷰티앱관련  START -->
	<select id="BEAUTYAPP_CATEGORY_SELECT" resultType="hashmap">
	<!--  뷰티관련 카테고리 SKINCARE,NAIL 등등값  -->
 	<![CDATA[
 		select categoryCode, categoryName, depth1 depth from category with(NOLOCK)  where  depth2=0 and depth3=0 and viewYn='Y' and depth1 < 7
    ]]>
	</select>
	
	<select id="BEAUTYAPP_BLINDTEST_ALL_SELECT" resultType="hashmap">
	<!--  blindtest 모든 게시물   -->
 	<![CDATA[
 		select top ${TOP} metacode,title,thumbnail  from (
 			select  ROW_NUMBER() OVER(ORDER BY ${ORDERBY} desc) as rownum ,Mainthumbnail thumbnail,title,blindseq metacode  from blindtest with (nolock)
 		) a where rownum > #{OFFSET} 
    ]]>
	</select>
	<select id="BEAUTYAPP_BLINDTEST_ALL_COUNT_SELECT" resultType="hashmap">
	<!--  blindtest 모든 게시물   -->
 	<![CDATA[
 		select  count(*) cnt  from blindtest with (nolock)
    ]]>
	</select>
	
	<select id="BEAUTYAPP_BLINDTEST_BY_CATEGORY_SELECT" resultType="hashmap">
	<!--  blindtest 카테고리별  게시물   -->
 	<![CDATA[
 		select top ${TOP} metacode,title,thumbnail  from  (
 			select  ROW_NUMBER() OVER(ORDER BY ${ORDERBY} desc) as rownum , Mainthumbnail thumbnail,title,blindseq metacode from blindtest with (nolock) where categoryCode > #{CATES} and categoryCode < #{CATEE}
 		) a where rownum > #{OFFSET} 
    ]]>
	</select>
	
	<select id="BEAUTYAPP_BLINDTEST_BY_CATEGORY_COUNT_SELECT" resultType="hashmap">
	<!--  blindtest 카테고리별  게시물   -->
 	<![CDATA[
 	
 		select  count(*) cnt from blindtest with (nolock) where categoryCode > #{CATES} and categoryCode < #{CATEE}
    ]]>
	</select>
	
	<select id="BEAUTYAPP_PRODUCT_ALL_SELECT" resultType="hashmap">
	<!--  모든 프로덕트 -->
 	<![CDATA[
 		select top ${TOP} metacode,title,thumbnail,brandKorName  from (
 			select ROW_NUMBER() OVER( order by ${ORDERBY} desc) as rownum ,productSeq metacode ,productname title , a.ImagePath thumbnail ,b.brandKorName  
 			from Product a with(NOLOCK) , brand b with(NOLOCK) where a.contentsYN='Y' and a.brandSeq = b.brandSeq  
 		) c where rownum > #{OFFSET} 
    ]]>
	</select>
	
	<select id="BEAUTYAPP_PRODUCT_ALL_COUNT_SELECT" resultType="hashmap">
	<!--  모든 프로덕트 -->
 	<![CDATA[
 			select count(*) cnt from Product a with(NOLOCK) where a.contentsYN='Y'  
    ]]>
	</select>
	
	<select id="BEAUTYAPP_PRODUCT_BY_CATEGORY_SELECT" resultType="hashmap">
	<!--  카테고리별 프로덕트  -->
 	<![CDATA[
 		select top ${TOP} metacode,title,thumbnail,brandKorName  from (
 			 select ROW_NUMBER() OVER( order by ${ORDERBY} desc) as rownum ,productSeq metacode ,productname title , a.ImagePath thumbnail ,b.brandKorName
 			 from Product a with(NOLOCK) , brand b with(NOLOCK) where a.contentsYN='Y' and a.brandSeq = b.brandSeq and categoryCode > #{CATES} and categoryCode < #{CATEE} 
 		) c where rownum > #{OFFSET} 
    ]]>
	</select>
	
	<select id="BEAUTYAPP_PRODUCT_BY_CATEGORY_COUNT_SELECT" resultType="hashmap">
	<!--  카테고리별 프로덕트  -->
 	<![CDATA[
 			 select count(*) cnt
 			 from Product a with(NOLOCK) where a.contentsYN='Y' and a.categoryCode > #{CATES} and a.categoryCode < #{CATEE} 
    ]]>
	</select>
	
	<!-- 브랜드 목록
		  이상하지만... 26보다 적었을 때도 count숫자가 제대로 나오게 만들려고. 
	-->
	<select id="BEAUTYAPP_BRAND_COUNT_SELECT" resultType="hashmap">
 	<![CDATA[
 		select count(*) from (
			select TOP 26 *
			from (
				select * 
				from brand with(NOLOCK)
				where viewType='Y'  and ContentsYN='Y' 
			) b
		) a
    ]]>
	</select>

	<select id="BEAUTYAPP_BRAND_SELECT" resultType="hashmap">
	<!--  브랜드 목록  -->
 	<![CDATA[
 		select top ${TOP} metacode, title, thumbnail, tipCnt from (
			select 
			   ROW_NUMBER() OVER(ORDER BY ${ORDER}) as rownum,
			   b.BrandSeq metacode, b.BrandKorName title, b.ImagePath thumbnail, tipCnt
			from (
				select TOP 26 BrandSeq, cnt tipCnt from (
					select c.BrandSeq, count(*) cnt
					from beautyTipProduct a with(NOLOCK), product b, brand c 
					where a.ProductSeq = b.ProductSeq 
					  and b.BrandSeq = c.BrandSeq
				   group by c.BrandSeq
				) a
				order by cnt desc
			) seqAndCnt, brand b
			where
			  seqAndCnt.BrandSeq = b.BrandSeq
			  and b.viewType='Y'  
			  and b.ContentsYN='Y'
		) b
		where rownum > #{OFFSET}
    ]]>
	</select>

	<select id="BEAUTYAPP_BRAND_INFO_SELECT" resultType="hashmap">
	<!-- 브랜드 정보  -->
 	<![CDATA[
 		select  ImagePath thumbnail,summary,brandKorname title from brand with(NOLOCK)  where viewType='Y'  and ContentsYN='Y' and brandSeq=#{BRANDID} 
    ]]>
	</select>
	
	<select id="BEAUTYAPP_TIP_SELECT" resultType="hashmap">
 	<![CDATA[
 	select TOP ${TOP} tipseq metacode, title,thumbnail from (
 		select  ROW_NUMBER() OVER( order by ${ORDERBY} desc,  infoYn,TipSeq desc ) as rownum , * from beautyTip with (nolock)  where viewType='Y' 
 		) a  where rownum > #{OFFSET}
    ]]>
	</select>
	
	<select id="BEAUTYAPP_TIP_COUNT_SELECT" resultType="hashmap">
 	<![CDATA[
 		select   count(*) cnt from beautyTip with (nolock)  where viewType='Y' 
    ]]>
	</select>
	
	<select id="PRODUCT_SELECT" resultType="hashmap">
	<![CDATA[
 		select * from product with (nolock) where productseq=#{SEQ} 
    ]]>
	</select>
	
	<select id="BEAUTYAPP_BRAND_CONTENT_SELECT" resultType="hashmap">
	<!--  브랜드 목록  -->
 	<![CDATA[
 		select TOP ${TOP} thumbnail,title,TipSeq metacode from  (
 			select ROW_NUMBER() OVER(ORDER BY ${ORDERBY} desc )as rownum, c.TipSeq,thumbnail,title 
 			from beautyTipProduct a with(NOLOCK) , product b  with(NOLOCK), beautyTip c with(NOLOCK)  
 			where a.ProductSeq = b.ProductSeq and a.TipContentsSeq = c.TipSeq and b.brandSeq=#{BRANDID} 
 		) a  where rownum > #{OFFSET}
    ]]>
	</select>
	
	<select id="BEAUTYAPP_BRAND_CONTENT_COUNT_SELECT" resultType="hashmap">
	<!--  브랜드 목록  -->
 	<![CDATA[
 			select count(*) cnt 
 			from beautyTipProduct a with(NOLOCK) , product b  with(NOLOCK), beautyTip c with(NOLOCK)  
 			where a.ProductSeq = b.ProductSeq and a.TipContentsSeq = c.TipSeq and b.brandSeq=#{BRANDID} 
    ]]>
	</select>


	<select id="BEAUTYAPP_BRAND_ETC_CONTENT_SELECT" resultType="hashmap">
	<!--  브랜드 목록  -->
 	<![CDATA[
 		select TOP ${TOP} thumbnail, title, TipSeq metacode from (
		   select ROW_NUMBER() OVER(ORDER BY ${ORDERBY} desc) as rownum, c.TipSeq, thumbnail, title
			from beautyTipProduct a with(NOLOCK), product b with(NOLOCK), beautyTip c with(NOLOCK)
			where a.ProductSeq = b.ProductSeq 
			  and a.TipContentsSeq = c.TipSeq 
			  and BrandSeq not in (
			   select TOP 26 BrandSeq from (
					select c.BrandSeq, count(*) cnt
					from beautyTipProduct a with(NOLOCK), product b, brand c 
					where a.ProductSeq = b.ProductSeq 
					  and b.BrandSeq = c.BrandSeq
				   group by c.BrandSeq
				) a
				order by cnt desc)
		)b where rownum > #{OFFSET}
    ]]>
	</select>
	
	<select id="BEAUTYAPP_BRAND_ETC_CONTENT_COUNT_SELECT" resultType="hashmap">
	<!--  ETC 브랜드 목록  -->
 	<![CDATA[
  	    select count(*)
		from beautyTipProduct a with(NOLOCK), product b with(NOLOCK), beautyTip c with(NOLOCK)
		where a.ProductSeq = b.ProductSeq 
		  and a.TipContentsSeq = c.TipSeq 
		  and BrandSeq not in (
		   select TOP 26 BrandSeq from (
				select c.BrandSeq, count(*) cnt
				from beautyTipProduct a with(NOLOCK), product b, brand c 
				where a.ProductSeq = b.ProductSeq 
				  and b.BrandSeq = c.BrandSeq
			   group by c.BrandSeq
			) a
			order by cnt desc)
    ]]>
	</select>
	
	
	
	<select id="THEME_ARTIST_CONTENT_COUNT_SELECT" resultType="hashmap">
 	<![CDATA[
 		select count(*) cnt from commonBoard with(NOLOCK)   where parentsCode=#{ARTISTID}
    ]]>
	</select>
	
	
	<select id="THEME_ARTIST_CONTENT_SELECT" resultType="hashmap">
 	<![CDATA[
 	select TOP ${TOP} thumbnail,metacode,title,cmsid,vodid,cmssubid from  (	
 		select ROW_NUMBER() OVER(ORDER BY ${ORDERBY} desc) as rownum, id metacode,thumbnail, createDate,title,cmsid,vodid,cmssubid
 	 		from commonBoard with(NOLOCK)   where parentsCode=#{ARTISTID}
 	) a  where rownum > #{OFFSET}
    ]]>
	</select>

	<select id="BEAUTY_TIP_MAIN_SELECT" resultType="hashmap">
	<!-- 뷰티팁  -->
 	<![CDATA[
 		select  title,thumbnail,summary,cmsid,cmssubid,vodid from beautyTip with (nolock) where tipSeq=#{TIPSEQ}
    ]]>
	</select>

	<select id="BEAUTY_TIP_CONTENT_SELECT" resultType="hashmap">
	<!-- 뷰티팁 컨텐츠  -->
 	<![CDATA[
 		select   thumbnail image , a.summary text
		from beautyTipContents a with (nolock)
		left outer join  beautyTipProduct b with(nolock)  on a.TipContentsSeq = b.TipContentsSeq  
		where a.tipSeq=#{TIPSEQ} 
		order by a.GroupSeq asc ,a.stepseq asc
    ]]>
	</select>
	
	<select id="THEME_TIP_CONTENT_SELECT" resultType="hashmap">
	<!--  테마 팁  -->
 	<![CDATA[
 		select  title,summary,contents,thumbnail,cmsid,cmssubid,vodid from commonBoard with(nolock) where id=#{ID}
    ]]>
	</select>
	
	<select id="BEAUTYAPP_PRODUCT_INFO_SELECT" resultType="hashmap">
 	<![CDATA[
 		select productseq "meatcode",productname "title", a.imagepath "thumbnail" ,b.brandKorName "brandName",a.summary, b.imagePath "brandThumbnail",a.price,a.capacity  
 		from Product a with(NOLOCK) , brand b with(NOLOCK)  where a.productseq=#{PRODUCTSEQ} and a.contentsYN='Y' and a.brandSeq = b.brandSeq  order by productSeq desc  
    ]]>
    </select>
	
	<select id="TIP_PRODUCT_SELECT" resultType="hashmap">
	<!--  팁게시물 중 프로덕트 정보 가져오기  -->
	<![CDATA[
	select   brandKorName,productName  , b.ImagePath  
	from  commonProduct  a with(nolock)  , product b with(nolock), brand c with(nolock)  
	where commonSeq=#{ID} and a.productSeq=b.productSeq and b.brandSeq = c.brandSeq
	]]>
	</select>
	
	<select id="BLINDTEST_CONTENT_SELECT" resultType="hashmap">
	<!-- blindtest 컨텐츠  -->
 	<![CDATA[
 		select  title,thumbnail,summary,contents ,cmsid, cmssubid,vodid from blindtest with (nolock) where blindseq=#{ID}
    ]]>
	</select>

	<select id="SHOP_ITEM_SELECT" resultType="hashmap">
	<!--  올리브 사이트  -->
 	<![CDATA[
 		select title,thumbnail,contents ,subContents from ShopNitem with (nolock) where ID=#{ID}
    ]]>
	</select>

	<select id="SHOP_ITEM_CONTENT_SELECT" resultType="hashmap">
	<!--  올리브 사이트  -->
 	<![CDATA[
 	select CategoryName,CodeText  
 	from ShopNitemContents a with (nolock), recipeCode b  with (nolock)  
 	where ID=#{ID} and a.CategoryCode = b.CategoryCode
    ]]>
	</select>


	<select id="EPISODE_GUIDE_CONTENT_SELECT" resultType="hashmap">
	<!--  에피소드 가이드  -->
 	<![CDATA[
		select title,contents from boardContents  with (nolock) where id=#{ID}
    ]]>
	</select>
	
	<select id="BLINDPRETEST_BY_ID_SELECT" resultType="hashmap">
 	<![CDATA[
 		select  title, contents, Thumbnail "thumbnail" from blindpretest with(nolock) where PretestSeq = #{ID} 
    ]]>
	</select>
	
	<select id="BOARDCONTENTS_BY_ID_SELECT" resultType="hashmap">
 	<![CDATA[
 		select title, contents, null "thumbnail" from boardContents  with (nolock) where boardDefinitionID=17 and id=#{ID} order by  id asc
    ]]>
	</select>
	
	<select id="COMMONBOARD_BY_ID_AND_CODE_SELECT" resultType="hashmap">
 	<![CDATA[
 		select title, contents, thumbnail "thumbnail" from commonBoard with (nolock) where id=#{ID} and parentsCode like '${CODE}%' and viewType='Y' 
    ]]>
	</select>

	<select id="GIB_WINNER_BY_ID_SELECT" resultType="hashmap">
 	<![CDATA[
		select RecipeID, title from battleWinner with (nolock) where channelCode='CHL006' and ViewYN='Y' and recipeID = #{ID}
    ]]>
	</select>
	
	<select id="GIB_BOX_BY_YM_SELECT" resultType="hashmap">
 	<![CDATA[
		select title, contents, startdate from mainContents with (nolock) where type='box' and startdate like '${YM}%'
    ]]>
	</select>
	
	<select id="SHOPNITEM_BY_ID_SELECT" resultType="hashmap">
 	<![CDATA[
		select * 
        from ShopNItem with (nolock)
        where ID = #{ID}
          and (RegisterDate <= GETDATE()) 
          AND (isDelete IN ('N', 'R')) 
    ]]>
	</select>

	<select id="RECIPE_EDITOR_BY_ID_SELECT" resultType="hashmap">
 	<![CDATA[
		select * 
        from RecipeEditor with (nolock)
        where ID = #{ID}
          and (RegisterDate <= GETDATE()) 
          AND (isDelete IN ('N', 'R')) 
    ]]>
	</select>

	<select id="RECIPE_PROGRAM_URL_SELECT" resultType="hashmap">
 	<![CDATA[
		  select * from RecipeCode where CategoryCode=#{CODE}
          and isDelete = 'N'
    ]]>
	</select>

	<select id="RECIPE_CHEF_BY_ID_SELECT" resultType="hashmap">
 	<![CDATA[
		select * 
        from RecipeChef with (nolock)
        where ChefCode = #{ChefCode}
          and isDelete = 'N'
    ]]>
	</select>

	<select id="RECIPE_BOARD_BY_ID_SELECT" resultType="hashmap">
 	<![CDATA[
		select * 
        from RecipeBoard with (nolock)
        where ID = #{ID}
          and isDelete = 'N'
    ]]>
	</select>

	<select id="ANOTHER_BOARDCONTENTS_BY_ID_SELECT" resultType="hashmap">
 	<![CDATA[
		select * 
        from boardContents with (nolock)
        where ID = #{ID}
          and isDelete = 'N' and isSecret ='N' and isViolation='N'
    ]]>
	</select>
</mapper>
